<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title></title>
    <link rel="stylesheet" href="css/style.css" />
    <script
      src="https://kit.fontawesome.com/98ce4f3177.js"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <!-- First section start -->

    <section id="nav">
      <div class="container-fluid">
        <div class="row">
          <div class="col-lg-4 col-md-10 col-sm-10 text-align-center nav-menu">
            <ul class="lists d-flex align-items-center gap-3">
              <li class="list-item font-size-18">
                <a href="products.html?id=1">Rings</a>
              </li>
              <li class="list-item font-size-18">
                <a href="products.html?id=2">Bracelets</a>
              </li>
              <li class="list-item font-size-18">
                <a href="products.html?id=3">Earrings</a>
              </li>
              <li class="list-item font-size-18">
                <a href="products.html?id=4">Necklaces</a>
              </li>
            </ul>
          </div>
          <div class="col-lg-4 col-md-9 col-sm-9 px-10 logo">
            <a href="index.html"
              ><img src="/img/home/logo-regular.png" alt
            /></a>
          </div>
          <div class="col-lg-4 col-md-10 col-sm-10 nav-menu">
            <ul class="lists d-flex align-items-center gap-3 flex-wrap">
              <li class="list-item font-size-18">
                <a href="index.html">Home</a>
              </li>
              <li class="list-item font-size-18">
                <a href="contact.html">Contact</a>
              </li>
              <li class="list-item font-size-18 loginList">
                <a href="login.html">Login</a>
              </li>
              <li class="list-item font-size-18 registerList">
                <a href="register.html">Register</a>
              </li>
              <li class="list-item font-size-18">
                <a href="#"><i class="fa-solid fa-magnifying-glass"></i></a>
              </li>
              <li class="list-item font-size-18">
                <a href="#" class="d-flex justify-content-center">
                  <i class="fa-solid fa-basket-shopping"></i>
                </a>
                <!-- Shopping Cart Sidebar -->
                <div class="shopping-cart-sidebar">
                  <div class="shopping-cart-header">
                    <h3>Shopping Cart</h3>
                    <button class="close-cart">
                      <i class="fa-solid fa-xmark"></i>
                    </button>
                  </div>
                  <div class="shopping-cart-content">
                    <p>No products in the cart.</p>
                  </div>
                  <div class="shopping-cart-footer">
                    <a class="btn btn-bg-butterum btn-shopping mt-3">
                      Continue Shopping
                    </a>
                  </div>
                </div>
              </li>
            </ul>
          </div>
          <div class="col-sm-2 menu-icon">
            <div class="menu-bar">
              <a class="menu-icon"><i class="fa-solid fa-bars"></i></a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- First section end -->

    <!--------------------------------------------->

    <!-- Third section start -->

    <section class="bg-light py-10" id="fourthSection">
      <div class="container-fluid">
        <div class="title px-10">
          <a href="index.html" class="title-link"></a>
          <h1 class="font-size-60 category-title my-2"></h1>
          <hr class="title-hr" />
        </div>
        <div class="row p-8 card-row"></div>
      </div>
    </section>

    <!-- Third section end -->

    <!---------------------------------------------->

    <!-- Footer section start -->

    <footer class="py-8 bg-caramel" id="footer">
      <div class="container-fluid mb-4">
        <div class="row align-items-start text-align-center">
          <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6 p-2">
            <img src="./img/home/logo-regular.png" alt />
          </div>
          <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6 p-2">
            <h1 class="font-weight-bolder mb-2">About Us</h1>
            <ul>
              <li class="mb-2"><a href="index.html">Home</a></li>
              <li class="mb-2"><a href="contact.html">Contact</a></li>
            </ul>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6 p-2">
            <h1 class="font-weight-bolder mb-2">Shop</h1>
            <ul>
              <li class="mb-2"><a href="products.html?id=1">Rings</a></li>
              <li class="mb-2"><a href="products.html?id=2">Bracelets</a></li>
              <li class="mb-2"><a href="products.html?id=3">Earrings</a></li>
              <li class="mb-2"><a href="products.html?id=4">Necklaces</a></li>
            </ul>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6 p-2">
            <h1 class="font-weight-bolder mb-2">Address</h1>
            <ul>
              <li class="mb-2"><a href="#">123 Fifth Avenue, New York,</a></li>
              <li class="mb-2"><a href="#">NY 10160</a></li>
              <li class="mb-2"><a href="#">contact@info.com</a></li>
              <li class="mb-2"><a href="#">929-242-6868</a></li>
            </ul>
          </div>
        </div>
      </div>
      <hr class="bg-gray w-100" />
      <div class="container-fluid">
        <div class="row">
          <div class="col-lg-12 col-md-12 col-sm-12">
            <p
              class="font-weight-ligher text-align-center py-1 pt-6 font-size-20"
            >
              Copyright Â© 2024 Blingg Jewelry | Powered by Blingg Jewelry
            </p>
          </div>
        </div>
      </div>
    </footer>

    <!-- Footer section end -->

    <script src="js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
      // Sadece bir mehsulun preview halini gosterme
      // Read Id from URL

      let url = new URL(window.location.href);
      let category_id = url.searchParams.get("id");
      // Find Category Name From Id
      let categoryName = "";
      for (let i = 0; i < data.categories.length; i++) {
        if (data.categories[i].id == category_id) {
          categoryName = data.categories[i].title;
        }
      }
      document.querySelector(".category-title").innerHTML = categoryName;
      document.querySelector("title").innerHTML = categoryName;
      document.querySelector(
        ".title-link"
      ).innerHTML = `Home / ${categoryName}`;

      function renderProductPreview(product_id) {
        let productView = "";
        for (let i = 0; i < data.products.length; i++) {
          if (data.products[i].id == product_id) {
            productView = `
                <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12 p-1">
                        <div class="card">
                            <img src="${data.products[i].images[0]}" alt="Product Image">
                            <div class="overlay">
                                <img src="${data.products[i].images[1]}" alt="Overlay Image">
                                <div class="overlay-icon">
                                    <a href="#" onclick="addToCart(${data.products[i].id})" class="mb-1 addToCart"><i class="fa-solid fa-basket-shopping"></i></a>
                                    <a href="product.html?id=${data.products[i].id}"><i class="fa-solid fa-eye"></i></a>
                                </div>
                            </div>
                            <div class="card-price">
                                <p class="font-weight-lighter font-size-24 my-1">${data.products[i].name}</p>
                                <p class="font-size-20">$${data.products[i].price}</p>
                            </div>
                        </div>
                    </div>
                `;
          }
        }

        return productView;
      }

      // Butun mehsullari gosterme
      function renderProducts(data) {
        let products = "";
        for (let i = 0; i < data.length; i++) {
          products += renderProductPreview(data[i].id);
        }
        return products;
      }

      function renderProductByCategory(category_id) {
        let productsByCategory = [];
        for (let i = 0; i < data.products.length; i++) {
          if (data.products[i].category_id == category_id) {
            productsByCategory.push(data.products[i]);
          }
        }
        return renderProducts(productsByCategory);
      }

      let cartData = [];
      let card_id = 1;
      document.querySelector(".card-row").innerHTML =
        renderProductByCategory(category_id);

      function addToCart(product_id) {
        event.preventDefault();
        let product = {
          id: card_id++,
          product_id: product_id,
          name: data.products[product_id - 1].name,
          price: data.products[product_id - 1].price,
          image: data.products[product_id - 1].images[0],
          category_id: data.products[product_id - 1].category_id,
          description: data.products[product_id - 1].description,
          user_id: null,
          quantity: 1,
        };
        cartData.push(product);

        // Add to local storage
        localStorage.setItem("cartData", JSON.stringify(cartData));
        updateCartDisplay();
        updateCartCount();
      }

      function updateCartDisplay() {
        let cart = localStorage.getItem("cartData");
        document.querySelector(".shopping-cart-content").innerHTML = "";
        let cartArray = JSON.parse(cart);
        for (let i = 0; i < cartArray.length; i++) {
          document.querySelector(".shopping-cart-content").innerHTML += `
            <div class="cartItem">
                <img src="${cartArray[i].image}" width="50px" height="50px" alt="">
                <div class="cartDetails">
                    <h3 class="title">${cartArray[i].name}</h3>
                    <div class="quantity">
                        <button class="decrease">-</button>
                        <input type="number" class="quantity-input" value="1" min="1">
                        <button class="increase">+</button>
                    </div>
                </div>
                <div class="cartPrice">
                    <button class="delete" onclick="removeCartItem(${cartArray[i].product_id})"><i class="fa-solid fa-trash"></i></button>
                    <h3 class="price">$${cartArray[i].price}</h3>
                </div>
            </div>`;
        }
      }

      // Update cart count
      function updateCartCount() {
        let cart = localStorage.getItem("cartData");
        let cartArray = JSON.parse(cart);
        document.querySelector(".fa-basket-shopping").innerHTML =
          cartArray.length;
      }

      // Read data from local storage
      function removeCartItem(product_id) {
        event.preventDefault();
        let cart = localStorage.getItem("cartData");
        let cartArray = JSON.parse(cart);
        for (let i = 0; i < cartArray.length; i++) {
          if (cartArray[i].product_id == product_id) {
            cartArray.splice(i, 1);
            break; // Exit the loop once the item is found and removed
          }
        }
        localStorage.setItem("cartData", JSON.stringify(cartArray));
        updateCartDisplay();
        updateCartCount();
      }

      // Initial cart update on page load
      updateCartDisplay();
      updateCartCount();
    </script>
  </body>
</html>
